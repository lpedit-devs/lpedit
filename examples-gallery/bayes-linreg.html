

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Bayesian Linear Regression &mdash; Reproducible Research</title>
    
    <link rel="stylesheet" href="../_static/agogo.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="Reproducible Research" href="../index.html" />
    <link rel="up" title="Gallery of examples" href="../ExamplesGallery.html" />
    <link rel="next" title="Beamer presentation with embedded Python" href="BeamerPresentation.html" />
    <link rel="prev" title="Permutation Test" href="PermutationTest.html" /> 
  </head>
  <body>
    <div class="header-wrapper">
      <div class="header">
          <p class="logo"><a href="../index.html">
            <img class="logo" src="../_static/logo.png" alt="Logo"/>
          </a></p>
        <div class="headertitle"><a
          href="../index.html">Reproducible Research</a></div>
        <div class="rel">
          <a href="PermutationTest.html" title="Permutation Test"
             accesskey="P">previous</a> |
          <a href="BeamerPresentation.html" title="Beamer presentation with embedded Python"
             accesskey="N">next</a> |
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a>
        </div>
       </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="bayesian-linear-regression">
<h1>Bayesian Linear Regression<a class="headerlink" href="#bayesian-linear-regression" title="Permalink to this headline">¶</a></h1>
<div class="section" id="the-model">
<h2>The model<a class="headerlink" href="#the-model" title="Permalink to this headline">¶</a></h2>
<p>Some of this infomation and notation is borrowed from Chapter 3 of C.M. Bishops <em>Pattern Recognition and Machine Learning</em> book <a class="reference internal" href="#bishop06">[Bishop06]</a>.
Lets assume that the target variable <img class="math" src="../_images/math/e0d2bf360290fd61d1c1557e763f2622363b3d35.png" alt="t"/> is a deterministic function with additive Gaussian noise.</p>
<blockquote>
<div><div class="math">
<p><img src="../_images/math/2b3a62bbfc4d2373c30a7b49e6cf0ca77f448a94.png" alt="t_n = y(\mathbf{x},\mathbf{w}) + \epsilon"/></p>
</div></div></blockquote>
<p>where</p>
<blockquote>
<div><div class="math">
<p><img src="../_images/math/30fea71e8de4d4df99acb10832d1834d762db4c3.png" alt="y(\mathbf{x},\mathbf{w}) &amp;= w_{0} + w_{1}x_{1} + \ldots + w_{D}x_{D}\\
                         &amp;= \sum^{M-1}_{j=1} w_{j} \phi(\mathbf{x})\\
                         &amp;= \mathbf{w}^{T} \bm{\phi}(\mathbf{x})"/></p>
</div></div></blockquote>
<p>The error term <img class="math" src="../_images/math/eaf4418fbe935c15a606516d8f55dc380cd8e822.png" alt="\epsilon"/> is a zero mean Gaussian random variable with precision <img class="math" src="../_images/math/fdb63b9e51abe6bbb16acfb5d7b773ddbb5bf4a8.png" alt="\beta"/>.
By using a basis function, <img class="math" src="../_images/math/32f700b32e1be802052575fd74f2ed274bf4c3b8.png" alt="\phi_{n}(\mathbf{x})"/> we may use non-linear transformations on the data,however, the model is still linear with respect to the weight vector <img class="math" src="../_images/math/9ee4b825a2e36ae093ed7be5e4851ef453b34914.png" alt="w"/>.  For convenience we define <img class="math" src="../_images/math/b910c2a38a6776b6500f5de93e7d3d48b3492cb6.png" alt="\phi_{0}(\mathbf{x}) = 1"/>.</p>
<p>The other basis functions may be nonlinear functions like the sigmoidal function of logistic sigmoid function.  We can write the <a class="reference external" href="http://en.wikipedia.org/wiki/Likelihood_function">likelihood</a> as</p>
<blockquote>
<div><div class="math">
<p><img src="../_images/math/59fd770ecd372ed7d7be12219bebcfac02d9097c.png" alt="p(\mathbf{t}|\mathbf{X},\mathbf{w},\bm{\beta}) &amp;=
\prod^{N}_{n=1} \mathcal{N}(t_{n}|\mathbf{w}^{T}\phi(\mathbf{x}_{n}),\beta^{-1})"/></p>
</div></div></blockquote>
<p>We formally define the model as:</p>
<blockquote>
<div><div class="math">
<p><img src="../_images/math/356228281dfca173bbdd4bb55da18377f873b87e.png" alt="\mathbf{w}_{0} &amp;\sim \mathcal{N}(0,1e-04)\\
\mathbf{w}_{1} &amp;\sim \mathcal{N}(0,1e-04)\\
\beta &amp;\sim \textrm{Gamma}(0.001,0.001)\\
t &amp;\sim \mathcal{N}(\bm{\mu},\beta^{-1})"/></p>
</div></div></blockquote>
<p>Given the model we can visualize the joint distribution using a plate diagram for this Bayesian linear regression model.</p>
<div class="align-center figure">
<a class="reference internal image-reference" href="../_images/LinRegPlateDiagram.png"><img alt="../_images/LinRegPlateDiagram.png" src="../_images/LinRegPlateDiagram.png" style="width: 170.0px; height: 217.5px;" /></a>
</div>
<p>Here is a summary of te parameters and variables</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="28%" />
<col width="72%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Parameter/Variable</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><img class="math" src="../_images/math/76a3e863dbbaa9520b067ff4ad098d0a342d8e60.png" alt="w_{0}"/></td>
<td><em>bias parameter</em> allows for any fixed offset in the data</td>
</tr>
<tr class="row-odd"><td><img class="math" src="../_images/math/bdbdd047a95185517a0e8b8e60a31f1a4984189c.png" alt="w_{1} \ldots w_{M-1}"/></td>
<td>regression coefficients</td>
</tr>
<tr class="row-even"><td><img class="math" src="../_images/math/e32f19fc37516d5df12ef5c0c7d509b5e7464c21.png" alt="\mathbf{t}"/></td>
<td><img class="math" src="../_images/math/fcfb0f75df2b01a8c4c6461d2f32ebf893f22a80.png" alt="t_{1},\ldots,t_{N}"/> - target variables</td>
</tr>
<tr class="row-odd"><td><img class="math" src="../_images/math/5ecbbc0083da71f2cbc69e1377535094685b108a.png" alt="\mathbf{X}"/></td>
<td><img class="math" src="../_images/math/7749dc8331307870bb52c351ee1b25098e9ce1b7.png" alt="\{ \mathbf{x}_{1} \ldots \mathbf{x}_{N} \}"/> - explanatory variables</td>
</tr>
<tr class="row-even"><td><img class="math" src="../_images/math/b932010f3196248418365a6c81c8fe6fecb6bb5c.png" alt="\phi_{n}(\mathbf{x}_{n})"/></td>
<td>basis functions</td>
</tr>
<tr class="row-odd"><td><img class="math" src="../_images/math/fdb63b9e51abe6bbb16acfb5d7b773ddbb5bf4a8.png" alt="\beta"/></td>
<td>precision parameter over <img class="math" src="../_images/math/e32f19fc37516d5df12ef5c0c7d509b5e7464c21.png" alt="\mathbf{t}"/></td>
</tr>
<tr class="row-even"><td><img class="math" src="../_images/math/2d8c833ed800824727cd7bd2fb9de1a12ad7e674.png" alt="\mu"/></td>
<td><img class="math" src="../_images/math/959f58a20978bc4943cd96f54c3563a3fd176b3f.png" alt="\mathbf{w}^{T}\phi(\mathbf{x}_{n})"/> mean parameter over <img class="math" src="../_images/math/e32f19fc37516d5df12ef5c0c7d509b5e7464c21.png" alt="\mathbf{t}"/></td>
</tr>
</tbody>
</table>
</div></blockquote>
</div>
<div class="section" id="generate-data-from-a-simple-model">
<h2>Generate data from a simple model<a class="headerlink" href="#generate-data-from-a-simple-model" title="Permalink to this headline">¶</a></h2>
<p>If for the moment we ignore the basis functions we can write the familiar form of linear regression as</p>
<blockquote>
<div><div class="math">
<p><img src="../_images/math/91ec36b74c32c7aacf635af551e0ee22f990cbeb.png" alt="t_{n} &amp;= w_{0} + w_{n} \mathbf{x}_{n} + \epsilon_{n}\\
\epsilon_{n} &amp;\sim \mathcal{N}(0,\beta^{-1})"/></p>
</div></div></blockquote>
<p>Lets generate data from <img class="math" src="../_images/math/342d32b6d0e96a743ccabb18fda2d79896be614e.png" alt="f(x,\mathbf{a}) = a_{0} + a_{1}x"/> where <img class="math" src="../_images/math/002874a78187b5377bf05880c1d5c4f8396e0465.png" alt="x \sim U(-1,1)"/>.
We assume the noise known so we set the precision  <img class="math" src="../_images/math/c0cd8a49720e79d66a8909ac0592e0e232247135.png" alt="\beta = 1/(0.2)^2 = 25"/>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="o">&lt;&lt;</span><span class="n">draw</span><span class="o">-</span><span class="n">samples</span><span class="o">&gt;&gt;=</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">101</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">draw_samples</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">a0</span><span class="p">,</span><span class="n">a1</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.5</span>
    <span class="n">trueX</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
    <span class="n">trueT</span> <span class="o">=</span> <span class="n">a0</span> <span class="o">+</span> <span class="p">(</span><span class="n">a1</span><span class="o">*</span><span class="n">trueX</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">trueX</span><span class="p">,</span> <span class="n">trueT</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">x</span><span class="p">,</span><span class="n">t</span> <span class="o">=</span> <span class="n">draw_samples</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&#39;x = </span><span class="si">%s</span><span class="s">&#39;</span><span class="o">%</span><span class="p">[</span><span class="nb">round</span><span class="p">(</span><span class="n">_x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">_x</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
<span class="k">print</span> <span class="s">&#39;t = </span><span class="si">%s</span><span class="s">&#39;</span><span class="o">%</span><span class="p">[</span><span class="nb">round</span><span class="p">(</span><span class="n">_t</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">_t</span> <span class="ow">in</span> <span class="n">t</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.14</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.94</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.66</span><span class="p">,</span> <span class="mf">0.37</span><span class="p">,</span> <span class="mf">0.67</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.39</span><span class="p">,</span> <span class="mf">0.79</span><span class="p">,</span> <span class="mf">0.44</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.62</span><span class="p">,</span> <span class="mf">0.11</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">]</span>
<span class="n">t</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.18</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.35</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.73</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.78</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.22</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.49</span><span class="p">,</span> <span class="mf">0.44</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.47</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.19</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.11</span><span class="p">]</span>
</pre></div>
</div>
<p>We will be using JAGS <a class="reference internal" href="#plummer03">[Plummer03]</a> to implement this model so we need to save the data to a file for later use.
So we need to save the data the same way that thr <cite>dump()</cite> function does in R.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="o">&lt;&lt;</span><span class="n">save</span><span class="o">-</span><span class="n">samples</span><span class="o">&gt;&gt;=</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="n">fid</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">&#39;line-reg-simple-data.R&#39;</span><span class="p">,</span><span class="s">&#39;w&#39;</span><span class="p">)</span>
<span class="n">fid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;x &lt;-</span><span class="se">\n</span><span class="s">c(</span><span class="si">%s</span><span class="s">)</span><span class="se">\n</span><span class="s">&#39;</span><span class="o">%</span><span class="p">(</span><span class="s">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="nb">str</span><span class="p">(</span><span class="n">_x</span><span class="p">)</span> <span class="k">for</span> <span class="n">_x</span> <span class="ow">in</span> <span class="n">x</span><span class="p">))))</span>
<span class="n">fid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;t &lt;-</span><span class="se">\n</span><span class="s">c(</span><span class="si">%s</span><span class="s">)</span><span class="se">\n</span><span class="s">&#39;</span><span class="o">%</span><span class="p">(</span><span class="s">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="nb">str</span><span class="p">(</span><span class="n">_t</span><span class="p">)</span> <span class="k">for</span> <span class="n">_t</span> <span class="ow">in</span> <span class="n">t</span><span class="p">))))</span>
<span class="n">fid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;N &lt;-</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s">&#39;</span><span class="o">%</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">N</span><span class="p">)))</span>
<span class="n">fid</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>
</pre></div>
</div>
</div>
<div class="section" id="set-up-the-rest-of-the-files-for-jags">
<h2>Set up the rest of the files for JAGS<a class="headerlink" href="#set-up-the-rest-of-the-files-for-jags" title="Permalink to this headline">¶</a></h2>
<div class="section" id="model-file">
<h3>Model file<a class="headerlink" href="#model-file" title="Permalink to this headline">¶</a></h3>
<p>We take the model defination provided in the previous section and put it into the BUGS language in the form of a file.  Here are the contents of that file.</p>
<div class="highlight-r"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre>model <span class="p">{</span>
    <span class="kr">for</span> <span class="p">(</span>i <span class="kr">in</span> <span class="m">1</span><span class="o">:</span>N<span class="p">)</span> <span class="p">{</span>
          mu<span class="p">[</span>i<span class="p">]</span> <span class="o">&lt;-</span> w0 <span class="o">+</span> w1<span class="o">*</span><span class="p">(</span>x<span class="p">[</span>i<span class="p">]</span> <span class="o">-</span> mean<span class="p">(</span>x<span class="p">));</span>
          t<span class="p">[</span>i<span class="p">]</span>   <span class="o">~</span> dnorm<span class="p">(</span>mu<span class="p">[</span>i<span class="p">],</span>beta<span class="p">);</span>
    <span class="p">}</span>
    w0       <span class="o">~</span> dnorm<span class="p">(</span><span class="m">0.0</span><span class="p">,</span><span class="m">1.0E-4</span><span class="p">);</span>
    w1       <span class="o">~</span> dnorm<span class="p">(</span><span class="m">0.0</span><span class="p">,</span><span class="m">1.0E-4</span><span class="p">);</span>
    beta      <span class="o">~</span> dgamma<span class="p">(</span><span class="m">1.0E-3</span><span class="p">,</span><span class="m">1.0E-3</span><span class="p">);</span>
    sigma   <span class="o">&lt;-</span> <span class="m">1.0</span><span class="o">/</span>sqrt<span class="p">(</span>beta<span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Download: <a class="reference download internal" href="../_downloads/line-reg-simple.bug"><tt class="xref download docutils literal"><span class="pre">line-reg-simple.bug</span></tt></a></p>
</div>
<div class="section" id="init-files">
<h3>Init files<a class="headerlink" href="#init-files" title="Permalink to this headline">¶</a></h3>
<p>We are going to run two MCMC chains so we need to initialize two files with initial values.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="o">&lt;&lt;</span><span class="n">save</span><span class="o">-</span><span class="n">init</span><span class="o">-</span><span class="n">files</span><span class="o">&gt;&gt;=</span>
<span class="k">for</span> <span class="n">fileName</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;line-reg-simple-inits-1.R&#39;</span><span class="p">,</span><span class="s">&#39;line-reg-simple-inits-2.R&#39;</span><span class="p">]:</span>
    <span class="n">fid</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fileName</span><span class="p">,</span><span class="s">&#39;w&#39;</span><span class="p">)</span>
    <span class="n">fid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;w0 &lt;- </span><span class="si">%s</span><span class="se">\n</span><span class="s">&#39;</span><span class="o">%</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.001</span><span class="p">,</span><span class="mf">1.0</span><span class="p">))))</span>
    <span class="n">fid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;w1 &lt;- </span><span class="si">%s</span><span class="se">\n</span><span class="s">&#39;</span><span class="o">%</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.001</span><span class="p">,</span><span class="mf">1.0</span><span class="p">))))</span>
    <span class="n">fid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;beta &lt;- </span><span class="si">%s</span><span class="se">\n</span><span class="s">&#39;</span><span class="o">%</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.001</span><span class="p">,</span><span class="mf">1.0</span><span class="p">))))</span>
    <span class="n">fid</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>
</pre></div>
</div>
</div>
<div class="section" id="commands-file">
<h3>Commands file<a class="headerlink" href="#commands-file" title="Permalink to this headline">¶</a></h3>
<p>Finally, the file specifing to JAGS which files to use and how to run the model.</p>
<div class="highlight-r"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="highlight"><pre><span class="o">/*</span> Simple regression model
<span class="o">*/</span>
model <span class="kr">in</span> <span class="s">&quot;line-reg-simple.bug&quot;</span>
data <span class="kr">in</span> <span class="s">&quot;line-reg-simple-data.R&quot;</span>
compile<span class="p">,</span> nchains<span class="p">(</span><span class="m">2</span><span class="p">)</span>
parameters <span class="kr">in</span> <span class="s">&quot;line-reg-simple-inits-1.R&quot;</span><span class="p">,</span> chain<span class="p">(</span><span class="m">1</span><span class="p">)</span>
parameters <span class="kr">in</span> <span class="s">&quot;line-reg-simple-inits-2.R&quot;</span><span class="p">,</span> chain<span class="p">(</span><span class="m">2</span><span class="p">)</span>
initialize
update <span class="m">1000</span>
monitor set w0
monitor set w1
monitor set sigma 
monitor set beta 
update <span class="m">20000</span> 
coda <span class="o">*</span>
</pre></div>
</td></tr></table></div>
<p>Download: <a class="reference download internal" href="../_downloads/line-reg-simple.cmd"><tt class="xref download docutils literal"><span class="pre">line-reg-simple.cmd</span></tt></a></p>
</div>
</div>
<div class="section" id="run-the-model">
<h2>Run the Model<a class="headerlink" href="#run-the-model" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><div class="highlight"><pre><span class="o">&lt;&lt;</span><span class="n">run</span><span class="o">-</span><span class="n">jags</span><span class="o">&gt;&gt;=</span>
<span class="kn">import</span> <span class="nn">subprocess</span><span class="o">,</span><span class="nn">time</span>
<span class="n">cmd</span> <span class="o">=</span> <span class="s">&#39;jags line-reg-simple.cmd&#39;</span>

<span class="n">process</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span><span class="n">shell</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span>
                           <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">)</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">stdOut</span><span class="p">,</span> <span class="n">stdErr</span> <span class="o">=</span> <span class="n">process</span><span class="o">.</span><span class="n">communicate</span><span class="p">()</span>
<span class="k">print</span> <span class="s">&#39;STDOUT</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">,</span><span class="n">stdOut</span>
<span class="k">print</span> <span class="s">&#39;STDERR</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">,</span><span class="n">stdErr</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">STDOUT</span>
<span class="n">Welcome</span> <span class="n">to</span> <span class="n">JAGS</span> <span class="mf">3.2</span><span class="o">.</span><span class="mi">0</span> <span class="n">on</span> <span class="n">Tue</span> <span class="n">Jun</span> <span class="mi">18</span> <span class="mi">11</span><span class="p">:</span><span class="mi">47</span><span class="p">:</span><span class="mi">55</span> <span class="mi">2013</span>
<span class="n">JAGS</span> <span class="ow">is</span> <span class="n">free</span> <span class="n">software</span> <span class="ow">and</span> <span class="n">comes</span> <span class="k">with</span> <span class="n">ABSOLUTELY</span> <span class="n">NO</span> <span class="n">WARRANTY</span>
<span class="n">Loading</span> <span class="n">module</span><span class="p">:</span> <span class="n">basemod</span><span class="p">:</span> <span class="n">ok</span>
<span class="n">Loading</span> <span class="n">module</span><span class="p">:</span> <span class="n">bugs</span><span class="p">:</span> <span class="n">ok</span>
<span class="n">Reading</span> <span class="n">data</span> <span class="nb">file</span> <span class="n">line</span><span class="o">-</span><span class="n">reg</span><span class="o">-</span><span class="n">simple</span><span class="o">-</span><span class="n">data</span><span class="o">.</span><span class="n">R</span>
<span class="n">Compiling</span> <span class="n">model</span> <span class="n">graph</span>
   <span class="n">Resolving</span> <span class="n">undeclared</span> <span class="n">variables</span>
   <span class="n">Allocating</span> <span class="n">nodes</span>
   <span class="n">Graph</span> <span class="n">Size</span><span class="p">:</span> <span class="mi">72</span>
<span class="n">Reading</span> <span class="n">parameter</span> <span class="nb">file</span> <span class="n">line</span><span class="o">-</span><span class="n">reg</span><span class="o">-</span><span class="n">simple</span><span class="o">-</span><span class="n">inits</span><span class="o">-</span><span class="mf">1.</span><span class="n">R</span>
<span class="n">Reading</span> <span class="n">parameter</span> <span class="nb">file</span> <span class="n">line</span><span class="o">-</span><span class="n">reg</span><span class="o">-</span><span class="n">simple</span><span class="o">-</span><span class="n">inits</span><span class="o">-</span><span class="mf">2.</span><span class="n">R</span>
<span class="n">Initializing</span> <span class="n">model</span>
<span class="n">Updating</span> <span class="mi">1000</span>
<span class="n">Updating</span> <span class="mi">20000</span>

<span class="n">STDERR</span>
</pre></div>
</div>
</div>
<div class="section" id="plot-the-chains">
<h2>Plot the chains<a class="headerlink" href="#plot-the-chains" title="Permalink to this headline">¶</a></h2>
<p>Make a plot of the MCMC chains showing the monitored variables</p>
<div class="highlight-python"><div class="highlight"><pre><span class="o">&lt;&lt;</span><span class="n">make</span><span class="o">-</span><span class="n">mcmc</span><span class="o">-</span><span class="n">plots</span><span class="o">&gt;&gt;=</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">PlottingLib</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">os</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s">&#39;CODAchain1.txt&#39;</span><span class="p">,</span> <span class="s">&#39;line-reg-simple-coda1.txt&#39;</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s">&#39;CODAchain2.txt&#39;</span><span class="p">,</span> <span class="s">&#39;line-reg-simple-coda2.txt&#39;</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s">&#39;CODAindex.txt&#39;</span><span class="p">,</span> <span class="s">&#39;line-reg-simple-index.txt&#39;</span><span class="p">)</span>
<span class="n">chainIdx</span> <span class="o">=</span> <span class="n">read_chain_index</span><span class="p">(</span><span class="s">&#39;line-reg-simple-index.txt&#39;</span><span class="p">)</span>
<span class="n">chain1</span> <span class="o">=</span> <span class="n">read_chain_file</span><span class="p">(</span><span class="s">&#39;line-reg-simple-coda1.txt&#39;</span><span class="p">)</span>
<span class="n">chain2</span> <span class="o">=</span> <span class="n">read_chain_file</span><span class="p">(</span><span class="n">line</span><span class="o">-</span><span class="n">reg</span><span class="o">-</span><span class="n">simple</span><span class="o">-</span><span class="n">coda2</span><span class="o">.</span><span class="n">txt</span><span class="p">)</span>
<span class="n">make_plots</span><span class="p">(</span><span class="n">chainIdx</span><span class="p">,</span><span class="n">chain1</span><span class="p">,</span><span class="n">chain2</span><span class="p">,</span><span class="n">figName</span><span class="o">=</span><span class="s">&#39;line-reg-simple-mcmc.png&#39;</span><span class="p">)</span>
<span class="n">estimates</span> <span class="o">=</span> <span class="n">get_estimates</span><span class="p">(</span><span class="n">chainIdx</span><span class="p">,</span><span class="n">chain1</span><span class="p">,</span><span class="n">chain2</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">showing</span> <span class="n">chain</span><span class="p">,</span> <span class="n">parameter</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="o">...</span>
</pre></div>
</div>
<p>As a reminder the values used to simulate the data were: <img class="math" src="../_images/math/09c493ee284db4bc22c9e4cc0c276fe0fb6aa638.png" alt="\beta = 25, \sigma = 0.2, w_{0} = -0.3, w_{1} = 0.5"/>.</p>
<div class="align-center figure">
<a class="reference internal image-reference" href="../_images/line-reg-simple-mcmc.png"><img alt="../_images/line-reg-simple-mcmc.png" src="../_images/line-reg-simple-mcmc.png" style="width: 400.0px; height: 300.0px;" /></a>
</div>
</div>
<div class="section" id="plot-the-lines">
<h2>Plot the lines<a class="headerlink" href="#plot-the-lines" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><div class="highlight"><pre><span class="o">&lt;&lt;</span><span class="n">make</span><span class="o">-</span><span class="n">line</span><span class="o">-</span><span class="n">plot</span><span class="o">&gt;&gt;=</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">polyval</span><span class="p">,</span><span class="n">polyfit</span>
<span class="kn">from</span> <span class="nn">RegressionLib</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c"># Get the fits</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">size</span>
<span class="n">fit</span><span class="o">=</span><span class="n">polyval</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span><span class="o">-</span><span class="mf">0.3</span><span class="p">],</span><span class="n">x</span><span class="p">)</span>
<span class="n">fit1</span><span class="o">=</span><span class="n">polyval</span><span class="p">([</span><span class="n">estimates</span><span class="p">[</span><span class="s">&#39;w1&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">estimates</span><span class="p">[</span><span class="s">&#39;w0&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]],</span><span class="n">x</span><span class="p">)</span>
<span class="n">fit1</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">estimates</span><span class="p">[</span><span class="s">&#39;sigma&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="n">mserror1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">fit1</span><span class="o">-</span><span class="n">t</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">n</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">&#39;Using Bayesian regression...&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;parameters: w0=</span><span class="si">%.2f</span><span class="s"> w1=</span><span class="si">%.2f</span><span class="s"> </span><span class="se">\n</span><span class="s">regression: w0=</span><span class="si">%.2f</span><span class="s"> w1=</span><span class="si">%.2f</span><span class="s">,std error= </span><span class="si">%.3f</span><span class="s">&#39;</span> <span class="o">%</span> \
     <span class="p">(</span><span class="o">-</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="n">estimates</span><span class="p">[</span><span class="s">&#39;w0&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">estimates</span><span class="p">[</span><span class="s">&#39;w1&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">mserror1</span><span class="p">))</span>

<span class="n">fit2</span><span class="p">,</span><span class="n">coeffs2</span> <span class="o">=</span> <span class="n">get_1D_linear_fit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>
<span class="n">fit2</span> <span class="o">=</span> <span class="n">fit2</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="n">mserror2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">fit2</span><span class="o">-</span><span class="n">t</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">n</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">Using least squares...&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;parameters: w0=</span><span class="si">%.2f</span><span class="s"> w1=</span><span class="si">%.2f</span><span class="s"> </span><span class="se">\n</span><span class="s">regression: w0=</span><span class="si">%.2f</span><span class="s"> w1=</span><span class="si">%.2f</span><span class="s">, ms error= </span><span class="si">%.3f</span><span class="s">&#39;</span> <span class="o">%</span> \
    <span class="p">(</span><span class="o">-</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="n">coeffs2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">coeffs2</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">mserror2</span><span class="p">))</span>

<span class="p">(</span><span class="n">ar</span><span class="p">,</span><span class="n">br</span><span class="p">)</span><span class="o">=</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fit3</span><span class="o">=</span><span class="n">polyval</span><span class="p">([</span><span class="n">ar</span><span class="p">,</span><span class="n">br</span><span class="p">],</span><span class="n">x</span><span class="p">)</span>
<span class="n">mserror3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">fit3</span><span class="o">-</span><span class="n">t</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">n</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">Using scipy.polyfit...&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;parameters: w0=</span><span class="si">%.2f</span><span class="s"> w1=</span><span class="si">%.2f</span><span class="s"> </span><span class="se">\n</span><span class="s">regression: w0=</span><span class="si">%.2f</span><span class="s"> w1=</span><span class="si">%.2f</span><span class="s">, ms error= </span><span class="si">%.3f</span><span class="s">&#39;</span> <span class="o">%</span> \
    <span class="p">(</span><span class="o">-</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="n">br</span><span class="p">,</span><span class="n">ar</span><span class="p">,</span><span class="n">mserror3</span><span class="p">))</span>

<span class="c"># determine the credible interval</span>
<span class="n">sampleSize</span> <span class="o">=</span> <span class="mi">5000</span>
<span class="n">w0Pst</span> <span class="o">=</span> <span class="n">get_posterior_sample</span><span class="p">(</span><span class="n">chainIdx</span><span class="p">,</span><span class="n">chain1</span><span class="p">,</span><span class="n">chain2</span><span class="p">,</span><span class="s">&#39;w0&#39;</span><span class="p">,</span><span class="n">sampleSize</span><span class="p">)</span>
<span class="n">w1Pst</span> <span class="o">=</span> <span class="n">get_posterior_sample</span><span class="p">(</span><span class="n">chainIdx</span><span class="p">,</span><span class="n">chain1</span><span class="p">,</span><span class="n">chain2</span><span class="p">,</span><span class="s">&#39;w1&#39;</span><span class="p">,</span><span class="n">sampleSize</span><span class="p">)</span>
<span class="n">sigmaPst</span> <span class="o">=</span> <span class="n">get_posterior_sample</span><span class="p">(</span><span class="n">chainIdx</span><span class="p">,</span><span class="n">chain1</span><span class="p">,</span><span class="n">chain2</span><span class="p">,</span><span class="s">&#39;sigma&#39;</span><span class="p">,</span><span class="n">sampleSize</span><span class="p">)</span>
<span class="n">lower</span><span class="p">,</span><span class="n">upper</span> <span class="o">=</span> <span class="p">[],[]</span>
<span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span><span class="n">x</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span><span class="mi">10</span><span class="p">)</span>
<span class="k">for</span> <span class="n">_xx</span> <span class="ow">in</span> <span class="n">xx</span><span class="p">:</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="p">(</span><span class="n">w0Pst</span> <span class="o">+</span> <span class="p">(</span><span class="n">w1Pst</span> <span class="o">*</span> <span class="n">_xx</span><span class="p">))</span>
    <span class="n">lower</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">))</span>
    <span class="n">upper</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span> <span class="mf">97.5</span><span class="p">))</span>

<span class="c"># plot</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="s">&#39;o&#39;</span><span class="p">)</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">fit</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s">&#39;#000000&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s">&#39;:&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">fit1</span><span class="p">,</span><span class="s">&#39;#FF5500&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s">&#39;-&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
<span class="n">p3</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">fit2</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s">&#39;#0055FF&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s">&#39;-&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">p2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">p3</span><span class="p">[</span><span class="mi">0</span><span class="p">]],[</span><span class="s">&#39;Original&#39;</span><span class="p">,</span><span class="s">&#39;Bayesian&#39;</span><span class="p">,</span><span class="s">&#39;Least Sqrs&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s">&#39;upper left&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">1.2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-</span><span class="mf">1.2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="n">ax1</span><span class="o">.</span><span class="n">get_data_ratio</span><span class="p">())</span>

<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">,</span><span class="n">aspect</span><span class="o">=</span><span class="s">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="s">&#39;o&#39;</span><span class="p">)</span>
<span class="n">p4</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">fit1</span><span class="p">,</span><span class="s">&#39;#FF5500&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s">&#39;-&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
<span class="n">p5</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="n">lower</span><span class="p">,</span><span class="s">&#39;#FF5500&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s">&#39;:&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
<span class="n">p6</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="n">upper</span><span class="p">,</span><span class="s">&#39;#FF5500&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s">&#39;:&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="n">p4</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">p5</span><span class="p">[</span><span class="mi">0</span><span class="p">]],[</span><span class="s">&#39;Bayesian&#39;</span><span class="p">,</span><span class="s">&#39;Cred. Inter.&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s">&#39;upper left&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">1.2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-</span><span class="mf">1.2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="n">ax2</span><span class="o">.</span><span class="n">get_data_ratio</span><span class="p">())</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;line-reg-simple-lines.png&#39;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">Using</span> <span class="n">Bayesian</span> <span class="n">regression</span><span class="o">...</span>
<span class="n">parameters</span><span class="p">:</span> <span class="n">w0</span><span class="o">=-</span><span class="mf">0.30</span> <span class="n">w1</span><span class="o">=</span><span class="mf">0.50</span>
<span class="n">regression</span><span class="p">:</span> <span class="n">w0</span><span class="o">=-</span><span class="mf">0.20</span> <span class="n">w1</span><span class="o">=</span><span class="mf">0.65</span><span class="p">,</span><span class="n">std</span> <span class="n">error</span><span class="o">=</span> <span class="mf">0.196</span>

<span class="n">Using</span> <span class="n">least</span> <span class="n">squares</span><span class="o">...</span>
<span class="n">parameters</span><span class="p">:</span> <span class="n">w0</span><span class="o">=-</span><span class="mf">0.30</span> <span class="n">w1</span><span class="o">=</span><span class="mf">0.50</span>
<span class="n">regression</span><span class="p">:</span> <span class="n">w0</span><span class="o">=-</span><span class="mf">0.18</span> <span class="n">w1</span><span class="o">=</span><span class="mf">0.65</span><span class="p">,</span> <span class="n">ms</span> <span class="n">error</span><span class="o">=</span> <span class="mf">0.195</span>

<span class="n">Using</span> <span class="n">scipy</span><span class="o">.</span><span class="n">polyfit</span><span class="o">...</span>
<span class="n">parameters</span><span class="p">:</span> <span class="n">w0</span><span class="o">=-</span><span class="mf">0.30</span> <span class="n">w1</span><span class="o">=</span><span class="mf">0.50</span>
<span class="n">regression</span><span class="p">:</span> <span class="n">w0</span><span class="o">=-</span><span class="mf">0.18</span> <span class="n">w1</span><span class="o">=</span><span class="mf">0.65</span><span class="p">,</span> <span class="n">ms</span> <span class="n">error</span><span class="o">=</span> <span class="mf">0.195</span>
</pre></div>
</div>
<div class="align-center figure">
<a class="reference internal image-reference" href="../_images/line-reg-simple-lines.png"><img alt="../_images/line-reg-simple-lines.png" src="../_images/line-reg-simple-lines.png" style="width: 720.0px; height: 540.0px;" /></a>
</div>
<p>Note that unlike a frequentist confidence interval the credible interval can be interpreted probabilistically.
For example, we can say that given the data there is a 95% chance that the parameter falls within the shown interval.</p>
<p>The additional functions are in:</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference download internal" href="../_downloads/PlottingLib.py"><tt class="xref download docutils literal"><span class="pre">PlottingLib.py</span></tt></a></li>
<li><a class="reference download internal" href="../_downloads/RegressionLib.py"><tt class="xref download docutils literal"><span class="pre">RegressionLib.py</span></tt></a></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="literature">
<h2>Literature<a class="headerlink" href="#literature" title="Permalink to this headline">¶</a></h2>
<table class="docutils citation" frame="void" id="bishop06" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[Bishop06]</a></td><td>C. M. Bishop. <em>Pattern Recognition and Machine Learning</em>,
Springer, August 2006.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="plummer03" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[Plummer03]</a></td><td>M. Plummer. <em>JAGS: A Program for Analysis of Bayesian Graphical Models Using Gibbs Sampling</em>,
Proceedings of the 3rd International Workshop on Distributed Statistical Computing, March 2003.</td></tr>
</tbody>
</table>
</div>
</div>


          </div>
        </div>
      </div>
        </div>
        <div class="sidebar">
          <h3>Table Of Contents</h3>
          <ul class="simple">
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../ReproducibleResearch.html">Reproducible Research</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Tutorial.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ExamplesGallery.html">Gallery of examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Resources.html">Resources and Presentations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Contributors.html">Contributers</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../lpEdit.html">lpEdit</a></li>
</ul>

          <h3 style="margin-top: 1.5em;">Search</h3>
          <form class="search" action="../search.html" method="get">
            <input type="text" name="q" />
            <input type="submit" value="Go" />
            <input type="hidden" name="check_keywords" value="yes" />
            <input type="hidden" name="area" value="default" />
          </form>
          <p class="searchtip" style="font-size: 90%">
            Enter search terms or a module, class or function name.
          </p>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer-wrapper">
      <div class="footer">
        <div class="left">
          <a href="PermutationTest.html" title="Permutation Test"
             >previous</a> |
          <a href="BeamerPresentation.html" title="Beamer presentation with embedded Python"
             >next</a> |
          <a href="../genindex.html" title="General Index"
             >index</a>
            <br/>
            <a href="../_sources/examples-gallery/bayes-linreg.txt"
               rel="nofollow">Show Source</a>
        </div>

        <div class="right">
          
    <div class="footer">
        &copy; Copyright 2013, Kouros Owzar, Andrzej Kosinski and Adam Richards.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

  </body>
</html>