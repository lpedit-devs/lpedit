%A Sweave template demonstrating plots
\documentclass[a4paper]{article}
\usepackage{amsmath,pgf,graphicx,textcomp}
\usepackage[utf8]{inputenc}

\title{Title of Document}
\author{Author Name}

\usepackage{Sweave}
\begin{document}
\input{PlotsInSweave-concordance}
\maketitle
\section{Heatmap}
We show how to create a simple heatmap using generated random numbers
in R. First we generate some random numbers and some labels.

\begin{Schunk}
\begin{Sinput}
> library(graphics)
> N <- 10
> M <- 5
> mat <- matrix(rnorm(M*N), N)
> rowLabels <- paste("r",1:N,sep="")
> colLabels <- paste("c",1:M,sep="")
\end{Sinput}
\end{Schunk}

\noindent Then we plot.
\begin{Schunk}
\begin{Sinput}
> pdf("example_heatmap.pdf",height=6,width=6)
> hmap <- heatmap(mat, Rowv=NA, Colv=NA,main='A title',
+                 col = heat.colors(256), scale="column",margins=c(3,3),
+                 labCol=colLabels, labRow=rowLabels)
> dev.off()
\end{Sinput}
\begin{Soutput}
null device 
          1 
\end{Soutput}
\end{Schunk}

\begin{figure}
\begin{center}
\includegraphics[ext=.pdf,scale = 0.9]{"example_heatmap"}
\end{center}
\caption{This is the figure caption}
\end{figure}
\end{document}
